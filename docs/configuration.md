# Configuration

Laravel TurboMaker can be configured to match your project's structure and preferences. This guide covers all available configuration options.

## Publishing Configuration

To customize TurboMaker's behavior, publish the configuration file:

```bash
php artisan vendor:publish --tag=turbomaker-config
```

This creates `config/turbomaker.php` in your project.

## Configuration File Structure

```php
<?php

return [
    /*
    |--------------------------------------------------------------------------
    | Default Generation Options
    |--------------------------------------------------------------------------
    |
    | These options control what gets generated by default when using
    | TurboMaker commands without explicit options.
    |
    */
    'defaults' => [
        'generate_api' => true,
        'generate_views' => true,
        'generate_tests' => false,
        'generate_factory' => false,
        'generate_seeder' => false,
        'generate_policies' => false,
        'generate_actions' => false,
        'generate_services' => false,
        'generate_rules' => false,
        'generate_observers' => false,
    ],

    /*
    |--------------------------------------------------------------------------
    | File Paths
    |--------------------------------------------------------------------------
    |
    | Configure where different types of files should be generated.
    |
    */
    'paths' => [
        'models' => 'app/Models',
        'controllers' => 'app/Http/Controllers',
        'api_controllers' => 'app/Http/Controllers/Api',
        'requests' => 'app/Http/Requests',
        'resources' => 'app/Http/Resources',
        'policies' => 'app/Policies',
        'actions' => 'app/Actions',
        'services' => 'app/Services',
        'rules' => 'app/Rules',
        'observers' => 'app/Observers',
        'migrations' => 'database/migrations',
        'factories' => 'database/factories',
        'seeders' => 'database/seeders',
        'views' => 'resources/views',
        'tests' => 'tests',
        'feature_tests' => 'tests/Feature',
        'unit_tests' => 'tests/Unit',
    ],

    /*
    |--------------------------------------------------------------------------
    | Stub Templates
    |--------------------------------------------------------------------------
    |
    | Configure which stub templates to use for code generation.
    | TurboMaker will first look for published stubs in your project,
    | then fallback to the package default stubs.
    |
    | To customize stubs, run: php artisan vendor:publish --tag=turbomaker-stubs
    |
    */
    'stubs' => [
        'path' => resource_path('stubs/turbomaker'),
        'templates' => [
            'model' => 'model.stub',
            'controller' => 'controller.stub',
            'api_controller' => 'controller.api.stub',
            'request_store' => 'request.store.stub',
            'request_update' => 'request.update.stub',
            'resource' => 'resource.stub',
            'policy' => 'policy.stub',
            'action_create' => 'action.create.stub',
            'action_update' => 'action.update.stub',
            'action_delete' => 'action.delete.stub',
            'action_get' => 'action.get.stub',
            'service' => 'service.stub',
            'rule_exists' => 'rule.exists.stub',
            'rule_unique' => 'rule.unique.stub',
            'observer' => 'observer.stub',
            'migration' => 'migration.stub',
            'factory' => 'factory.stub',
            'seeder' => 'seeder.stub',
            'test_feature' => 'test.feature.stub',
            'test_unit' => 'test.unit.stub',
            'view_index' => 'view.index.stub',
            'view_create' => 'view.create.stub',
            'view_edit' => 'view.edit.stub',
            'view_show' => 'view.show.stub',
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | Routes Configuration
    |--------------------------------------------------------------------------
    |
    | Configure how routes are generated and added to route files.
    |
    */
    'routes' => [
        'web_file' => base_path('routes/web.php'),
        'api_file' => base_path('routes/api.php'),
        'api_prefix' => 'api',
        'api_middleware' => ['api'],
        'web_middleware' => ['web'],
        'generate_resource_routes' => true,
        'generate_api_routes' => true,
    ],

    /*
    |--------------------------------------------------------------------------
    | Model Configuration
    |--------------------------------------------------------------------------
    |
    | Configure default model behavior and traits.
    |
    */
    'model' => [
        'namespace' => 'App\\Models',
        'base_class' => 'Illuminate\\Database\\Eloquent\\Model',
        'default_traits' => [
            // 'Illuminate\\Database\\Eloquent\\SoftDeletes',
            // 'Illuminate\\Database\\Eloquent\\Concerns\\HasUuids',
        ],
        'default_casts' => [
            // 'created_at' => 'datetime',
            // 'updated_at' => 'datetime',
        ],
        'use_timestamps' => true,
        'use_soft_deletes' => false,
        'use_uuids' => false,
    ],

    /*
    |--------------------------------------------------------------------------
    | Database Configuration
    |--------------------------------------------------------------------------
    |
    | Configure default database settings for migrations and models.
    |
    */
    'database' => [
        'migration_table_prefix' => '',
        'migration_table_suffix' => '',
        'foreign_key_format' => '{table}_id',
        'use_foreign_key_constraints' => true,
        'cascade_on_delete' => true,
        'default_string_length' => 255,
    ],

    /*
    |--------------------------------------------------------------------------
    | Testing Configuration
    |--------------------------------------------------------------------------
    |
    | Configure test generation behavior.
    |
    */
    'testing' => [
        'framework' => 'pest', // 'pest' or 'phpunit'
        'feature_test_suffix' => 'Test',
        'unit_test_suffix' => 'Test',
        'generate_factories_for_tests' => true,
        'use_database_transactions' => true,
    ],

    /*
    |--------------------------------------------------------------------------
    | View Configuration
    |--------------------------------------------------------------------------
    |
    | Configure view generation and layout options.
    |
    */
    'views' => [
        'layout' => 'layouts.app',
        'css_framework' => 'bootstrap', // 'bootstrap', 'tailwind', 'none'
        'generate_pagination' => true,
        'items_per_page' => 15,
    ],

    /*
    |--------------------------------------------------------------------------
    | API Configuration
    |--------------------------------------------------------------------------
    |
    | Configure API resource generation and structure.
    |
    */
    'api' => [
        'namespace' => 'App\\Http\\Resources',
        'version_prefix' => 'v1',
        'use_api_resources' => true,
        'generate_collection_resources' => true,
        'pagination_wrapper' => true,
    ],

    /*
    |--------------------------------------------------------------------------
    | Code Style Configuration
    |--------------------------------------------------------------------------
    |
    | Configure code formatting and style preferences.
    |
    */
    'code_style' => [
        'php_cs_fixer' => false,
        'pint' => true,
        'auto_format' => false,
        'strict_types' => true,
        'docblocks' => true,
    ],
];
```

## Configuration Options Explained

### Default Generation Options

Control what components are generated by default:

```php
'defaults' => [
    'generate_api' => true,        // Generate API controllers and resources
    'generate_views' => true,      // Generate Blade views
    'generate_tests' => false,     // Generate tests automatically
    'generate_factory' => false,   // Generate model factories
    'generate_seeder' => false,    // Generate seeders
    'generate_policies' => false,  // Generate authorization policies
    'generate_actions' => false,   // Generate action classes
    'generate_services' => false,  // Generate service classes
    'generate_rules' => false,     // Generate validation rules
    'generate_observers' => false, // Generate model observers
],
```

### File Paths

Customize where different types of files are generated:

```php
'paths' => [
    'models' => 'app/Models',                    // Eloquent models
    'controllers' => 'app/Http/Controllers',     // Web controllers
    'api_controllers' => 'app/Http/Controllers/Api', // API controllers
    'actions' => 'app/Actions',                  // Action classes
    'services' => 'app/Services',                // Service classes
    // ... more paths
],
```

### Custom Namespaces

For projects with different namespace structures:

```php
'paths' => [
    'models' => 'src/Domain/Models',
    'controllers' => 'src/Http/Controllers',
    'services' => 'src/Application/Services',
],
```

### Model Configuration

Customize default model behavior:

```php
'model' => [
    'namespace' => 'App\\Models',
    'base_class' => 'App\\Models\\BaseModel',  // Custom base model
    'default_traits' => [
        'Illuminate\\Database\\Eloquent\\SoftDeletes',
        'App\\Traits\\Auditable',
    ],
    'use_uuids' => true,  // Use UUIDs instead of auto-increment IDs
],
```

### Database Configuration

Configure database-related generation:

```php
'database' => [
    'migration_table_prefix' => 'app_',     // Prefix for table names
    'foreign_key_format' => '{table}_uuid', // Custom foreign key format
    'use_foreign_key_constraints' => false, // Disable FK constraints
    'default_string_length' => 191,         // For older MySQL versions
],
```

### Testing Framework

Configure test generation:

```php
'testing' => [
    'framework' => 'phpunit',  // Use PHPUnit instead of Pest
    'use_database_transactions' => false,
    'generate_factories_for_tests' => false,
],
```

### View Configuration

Customize view generation:

```php
'views' => [
    'layout' => 'layouts.admin',    // Custom layout
    'css_framework' => 'tailwind',  // Use Tailwind CSS
    'items_per_page' => 25,         // Pagination
],
```

### API Configuration

Configure API generation:

```php
'api' => [
    'version_prefix' => 'v2',       // API version
    'use_api_resources' => false,   // Skip API resources
    'pagination_wrapper' => false,  // Simple pagination
],
```

## Environment-Specific Configuration

You can override configuration values in different environments:

**config/turbomaker.php:**
```php
return [
    'defaults' => [
        'generate_tests' => env('TURBOMAKER_GENERATE_TESTS', false),
        'generate_factory' => env('TURBOMAKER_GENERATE_FACTORY', false),
    ],
    
    'code_style' => [
        'auto_format' => env('TURBOMAKER_AUTO_FORMAT', false),
    ],
];
```

**.env:**
```bash
# Development environment
TURBOMAKER_GENERATE_TESTS=true
TURBOMAKER_GENERATE_FACTORY=true
TURBOMAKER_AUTO_FORMAT=true
```

**.env.production:**
```bash
# Production environment
TURBOMAKER_GENERATE_TESTS=false
TURBOMAKER_GENERATE_FACTORY=false
TURBOMAKER_AUTO_FORMAT=false
```

## Team Configuration

For team projects, consider these settings:

```php
return [
    // Consistent file generation
    'defaults' => [
        'generate_tests' => true,
        'generate_factory' => true,
        'generate_policies' => true,
    ],
    
    // Enforce code standards
    'code_style' => [
        'strict_types' => true,
        'docblocks' => true,
        'auto_format' => true,
    ],
    
    // Consistent database structure
    'database' => [
        'use_foreign_key_constraints' => true,
        'cascade_on_delete' => false, // Be explicit about cascades
    ],
];
```

## Advanced Configuration

### Custom Stub Path per Template

```php
'stubs' => [
    'templates' => [
        'model' => resource_path('stubs/custom/model.stub'),
        'controller' => resource_path('stubs/shared/controller.stub'),
        // Other templates use default path
    ],
],
```

### Conditional Configuration

```php
'model' => [
    'default_traits' => app()->environment('testing') ? [] : [
        'App\\Traits\\Auditable',
        'App\\Traits\\Cacheable',
    ],
],
```

### Multiple Environments

```php
'testing' => [
    'framework' => app()->environment(['local', 'testing']) ? 'pest' : 'phpunit',
    'use_database_transactions' => !app()->environment('production'),
],
```

## Configuration Validation

TurboMaker validates configuration on startup. Common validation errors:

### Invalid Paths
```bash
# Error: Path does not exist
'paths' => [
    'models' => 'invalid/path', // This will cause an error
],
```

### Missing Stub Files
```bash
# Error: Stub file not found
'stubs' => [
    'templates' => [
        'model' => 'missing.stub', // This will cause an error
    ],
],
```

### Invalid Namespaces
```bash
# Error: Invalid namespace format
'model' => [
    'namespace' => 'Invalid\\Namespace\\Format\\', // Trailing slash
],
```

## Best Practices

### 1. Version Control Configuration
Always commit your configuration file to version control.

### 2. Environment-Specific Settings
Use environment variables for settings that vary between environments.

### 3. Team Standards
Establish team standards for code generation and document them.

### 4. Gradual Adoption
Start with default settings and gradually customize as needed.

### 5. Test Configuration
Test your configuration with sample modules before using in production.

### 6. Backup Before Changes
Always backup your configuration before making significant changes.

## Troubleshooting

### Configuration Not Loading
1. Clear configuration cache: `php artisan config:clear`
2. Ensure file is properly published
3. Check file permissions

### Generation Errors
1. Verify all paths exist and are writable
2. Check stub file paths are correct
3. Validate namespace formats

### Performance Issues
1. Disable auto-formatting during development
2. Reduce default component generation
3. Use specific commands instead of `turbo:make` with all options

## Examples

See the [examples/configuration](../examples/configuration/) directory for:
- Complete configuration examples
- Team-specific configurations
- Environment-specific setups
- Performance-optimized configurations